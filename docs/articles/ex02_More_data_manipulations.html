<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example 02: More data manipulations • FishStomachs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example 02: More data manipulations">
<meta property="og:description" content="FishStomachs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FishStomachs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/FishStomachs.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ex01_Read_and_manipulate_data.html">example 01: Read and manipulate data</a>
    </li>
    <li>
      <a href="../articles/ex02_More_data_manipulations.html">Example 02: More data manipulations</a>
    </li>
    <li>
      <a href="../articles/ex03_Estimate_population_diet.html">Example 03: Estimate population diet</a>
    </li>
    <li>
      <a href="../articles/ex04_Population_diet.html">Example 04: Population diet</a>
    </li>
    <li>
      <a href="../articles/ex05_Create_data_for_model.html">Example 05:Create data for model</a>
    </li>
    <li>
      <a href="../articles/ex06_Bootstrapping.html">Example 06 Bootstrapping</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example 02: More data manipulations</h1>
            
      
      
      <div class="hidden name"><code>ex02_More_data_manipulations.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FishStomachs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FishStomachs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load data from example 01</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span> package <span class="op">=</span> <span class="st">"FishStomachs"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"ex01.Rdata"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s</span></span>
<span><span class="co">#&gt; Object of class 'STOMobs'</span></span>
<span><span class="co">#&gt; ===========================</span></span>
<span><span class="co">#&gt; Number of samples: 4104 </span></span>
<span><span class="co">#&gt; Number stomachs: 9660 </span></span>
<span><span class="co">#&gt; Predators: Gadus morhua </span></span>
<span><span class="co">#&gt; Number of prey names: 222 </span></span>
<span><span class="co">#&gt; Years: 1991 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; TRUE:  Changes done</span></span>
<span><span class="co">#&gt; TRUE:  Prey weights by record done</span></span>
<span><span class="co">#&gt; FALSE: Bias corrected, energy contents, armament etc</span></span>
<span><span class="co">#&gt; FALSE: Predator size class assigned</span></span>
<span><span class="co">#&gt; FALSE: Bias corrected, regurgitated stomachs</span></span>
<span><span class="co">#&gt; FALSE: Prey size class assigned</span></span>
<span><span class="co">#&gt; FALSE: Aggregate by sample ID and predator and prey size group</span></span>
<span><span class="co">#&gt; FALSE: Temporal and spatial strata added</span></span>
<span><span class="co">#&gt; FALSE: Allocate partly identified prey species</span></span>
<span><span class="co">#&gt; FALSE: Allocate missing prey length</span></span></code></pre></div>
<p>A series of data manipulations, with addition of new variables, are
needed before the population diet (or food ration) can be calculated.
This example shows how the FishStomachs function can be used.</p>
<div class="section level3">
<h3 id="bias-correct-energy-contents-arament-etc-">Bias correct, energy contents, arament etc.<a class="anchor" aria-label="anchor" href="#bias-correct-energy-contents-arament-etc-"></a>
</h3>
<p>Bias correction of stomach evacuation rate and thereby stomach
content due to different energy contents, armament of the prey items can
optional be done by the function bias_correct_energy_etc(), based on the
work by Andersen and Beyer, xxx. The function call uses several extra
information kept on files for the bias correction, see the help for
bias_correct_energy_etc(). In this example, these input files a supplied
with the FishStomachs.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data for grouping of prey items based on the NODC which provide an easy grouping.  </span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span> package <span class="op">=</span> <span class="st">"FishStomachs"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"consum_nodc.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">39</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (1): species_group</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (2): First, Last</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 39 × 3</span></span></span>
<span><span class="co">#&gt;    species_group          First       Last</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Other              400<span style="text-decoration: underline;">000</span>000 <span style="text-decoration: underline;">4</span>700<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Annelida          <span style="text-decoration: underline;">5</span>000<span style="text-decoration: underline;">000</span>000 <span style="text-decoration: underline;">5</span>001<span style="text-decoration: underline;">700</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Other Inv.        <span style="text-decoration: underline;">5</span>001<span style="text-decoration: underline;">710</span>000 <span style="text-decoration: underline;">5</span>699<span style="text-decoration: underline;">999</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Cephalopoda       <span style="text-decoration: underline;">5</span>700<span style="text-decoration: underline;">000</span>000 <span style="text-decoration: underline;">5</span>799<span style="text-decoration: underline;">999</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Other Inv.        <span style="text-decoration: underline;">6</span>000<span style="text-decoration: underline;">000</span>000 <span style="text-decoration: underline;">6</span>099<span style="text-decoration: underline;">999</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Other Crustaceans <span style="text-decoration: underline;">6</span>100<span style="text-decoration: underline;">000</span>000 <span style="text-decoration: underline;">6</span>173<span style="text-decoration: underline;">999</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Euphausiacea      <span style="text-decoration: underline;">6</span>174<span style="text-decoration: underline;">000</span>000 <span style="text-decoration: underline;">6</span>174<span style="text-decoration: underline;">999</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Other Crustaceans <span style="text-decoration: underline;">6</span>175<span style="text-decoration: underline;">000</span>000 <span style="text-decoration: underline;">6</span>178<span style="text-decoration: underline;">999</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Caridea           <span style="text-decoration: underline;">6</span>179<span style="text-decoration: underline;">000</span>000 <span style="text-decoration: underline;">6</span>179<span style="text-decoration: underline;">999</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Astacidea         <span style="text-decoration: underline;">6</span>180<span style="text-decoration: underline;">000</span>000 <span style="text-decoration: underline;">6</span>181<span style="text-decoration: underline;">999</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 29 more rows</span></span></span>
<span></span>
<span><span class="co"># Parameters for the stomach evacuation model</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span> package <span class="op">=</span> <span class="st">"FishStomachs"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"parameters.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">10</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (1): pred_name</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (7): pred_nodc, rho, lambda, delta, xi, alfa, k</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 8</span></span></span>
<span><span class="co">#&gt;    pred_name                 pred_nodc     rho lambda delta    xi  alfa     k</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Gadus morhua             <span style="text-decoration: underline;">8</span>791<span style="text-decoration: underline;">030</span>402 0.002<span style="text-decoration: underline;">24</span>   1.3  0.083 -<span style="color: #BB0000;">0.85</span>   0.5  0.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Melanogrammus aeglefinus <span style="text-decoration: underline;">8</span>791<span style="text-decoration: underline;">031</span>301 0.001<span style="text-decoration: underline;">91</span>   1.3  0.083 -<span style="color: #BB0000;">0.85</span>   0.5  0.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Pollachius virens        <span style="text-decoration: underline;">8</span>791<span style="text-decoration: underline;">030</span>901 0.001<span style="text-decoration: underline;">71</span>   1.35 0.081 -<span style="color: #BB0000;">0.85</span>   0.5  0.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Merlangius merlangus     <span style="text-decoration: underline;">8</span>791<span style="text-decoration: underline;">031</span>801 0.001<span style="text-decoration: underline;">71</span>   1.35 0.081 -<span style="color: #BB0000;">0.85</span>   0.5  0.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Scomber scombrus         <span style="text-decoration: underline;">8</span>850<span style="text-decoration: underline;">030</span>302 0.001<span style="text-decoration: underline;">74</span>   1.3  0.08  -<span style="color: #BB0000;">0.85</span>   0.5  0.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> COD                      <span style="text-decoration: underline;">8</span>791<span style="text-decoration: underline;">030</span>402 0.002<span style="text-decoration: underline;">24</span>   1.3  0.083 -<span style="color: #BB0000;">0.85</span>   0.5  0.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> HAD                      <span style="text-decoration: underline;">8</span>791<span style="text-decoration: underline;">031</span>301 0.001<span style="text-decoration: underline;">91</span>   1.3  0.083 -<span style="color: #BB0000;">0.85</span>   0.5  0.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> POK                      <span style="text-decoration: underline;">8</span>791<span style="text-decoration: underline;">030</span>901 0.001<span style="text-decoration: underline;">71</span>   1.35 0.081 -<span style="color: #BB0000;">0.85</span>   0.5  0.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> WHG                      <span style="text-decoration: underline;">8</span>791<span style="text-decoration: underline;">031</span>801 0.001<span style="text-decoration: underline;">71</span>   1.35 0.081 -<span style="color: #BB0000;">0.85</span>   0.5  0.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> MAC                      <span style="text-decoration: underline;">8</span>850<span style="text-decoration: underline;">030</span>302 0.001<span style="text-decoration: underline;">74</span>   1.3  0.08  -<span style="color: #BB0000;">0.85</span>   0.5  0.85</span></span>
<span></span>
<span><span class="co"># Ambient temperature by ICES rectangel and quarter</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span> package <span class="op">=</span> <span class="st">"FishStomachs"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"temperature.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">860</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (1): rectangle</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (2): quarter, Temp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 860 × 3</span></span></span>
<span><span class="co">#&gt;    rectangle quarter  Temp</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 31F1            1  6.05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 31F2            1  6.72</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 31F3            1  6.12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 32F1            1  6.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 32F2            1  6.37</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 32F3            1  6.21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 33F1            1  5.71</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 33F2            1  5.91</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 33F3            1  6.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 33F4            1  5.46</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 850 more rows</span></span></span>
<span></span>
<span><span class="co"># Data on energy contents and armament etc</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span> package <span class="op">=</span> <span class="st">"FishStomachs"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"energy_density_and_armament.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">216</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (1): species_group</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (5): quarter, lower, upper, E, Armer</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 216 × 6</span></span></span>
<span><span class="co">#&gt;    species_group quarter lower upper     E Armer</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Gadus morhua        1    10   120   3.6     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Gadus morhua        1   150   250   3.8     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Gadus morhua        1   300   500   4       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Gadus morhua        2    10   120   3.9     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Gadus morhua        2   150   500   4.1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Gadus morhua        3    10    80   3.9     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Gadus morhua        3   100   150   4.1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Gadus morhua        3   200   500   4.4     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Gadus morhua        3    10    80   3.9     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Gadus morhua        3   100   150   4.1     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 206 more rows</span></span></span></code></pre></div>
<p>And here is the call to the function and its results for the detailed
dataset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/bias_correct_energy_etc.html">bias_correct_energy_etc</a></span><span class="op">(</span><span class="va">s</span>,hour_multiplier<span class="op">=</span><span class="fl">2190</span>,</span>
<span>         nodc_group_file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span> package <span class="op">=</span> <span class="st">"FishStomachs"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"consum_nodc.csv"</span><span class="op">)</span>,</span>
<span>              param_file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span> package <span class="op">=</span> <span class="st">"FishStomachs"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"parameters.csv"</span><span class="op">)</span>,</span>
<span>        temperature_file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span> package <span class="op">=</span> <span class="st">"FishStomachs"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"temperature.csv"</span><span class="op">)</span>,</span>
<span>             energy_file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span> package <span class="op">=</span> <span class="st">"FishStomachs"</span><span class="op">)</span>,<span class="st">"extdata"</span>,<span class="st">"energy_density_and_armament.csv"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span><span class="co">#&gt; Energy and armament data were not found for the data shown below: </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 192 × 24</span></span></span>
<span><span class="co">#&gt;    sample_id fish_id prey_…¹ digest prey_l prey_ll prey_lu prey_…² prey_n prey_w</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Gadus mo… 232     Unknown      9   <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999 r            0   0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Gadus mo… 333     Unknown      9   <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999 r            0   0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Gadus mo… 424     Unknown      9   <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999 r            0   0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Gadus mo… 54      Unknown      9   <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999 r            0   0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Gadus mo… 55      Unknown      9   <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999 r            0   0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Gadus mo… 889     Pleuro…      2   <span style="text-decoration: underline;">9</span>999     150     200 r            1   5.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Gadus mo… 1027    Unknown      9   <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999 r            0   0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Gadus mo… 1413    Unknown      9   <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999 r            0   0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Gadus mo… 1563    Unknown      9   <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999 r            0   0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Gadus mo… 3210    Unknown      9   <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999    <span style="text-decoration: underline;">9</span>999 r            0   0   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 182 more rows, 14 more variables: prey_nodc &lt;dbl&gt;, pred_l &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   n_tot &lt;int&gt;, n_food &lt;int&gt;, delta &lt;dbl&gt;, rho &lt;dbl&gt;, lambda &lt;dbl&gt;, xi &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   alfa &lt;dbl&gt;, k &lt;dbl&gt;, Temp &lt;dbl&gt;, species_group &lt;chr&gt;, E &lt;dbl&gt;, Armer &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   and abbreviated variable names ¹​prey_name, ²​prey_w_meth</span></span></span>
<span><span class="co">#&gt;  Average values of Energy contents and Armament will be used'</span></span>
<span>      </span>
<span>  <span class="fu"><a href="../reference/do_detailed_output.html">do_detailed_output</a></span><span class="op">(</span><span class="va">s</span>, by_sample_id<span class="op">=</span><span class="cn">TRUE</span>,to_screen<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  sample_id: Gadus morhua_FRA_y:91_q:1_ID:1008  fish_id: 1008 </span></span>
<span><span class="co">#&gt; Number of stomachs ('n_tot'): 1 </span></span>
<span><span class="co">#&gt;                              80     100     120      150     200      250</span></span>
<span><span class="co">#&gt; Aphrodite aculeata           NA      NA      NA       NA      NA       NA</span></span>
<span><span class="co">#&gt; Callionymus lyra         6171.7      NA      NA       NA      NA       NA</span></span>
<span><span class="co">#&gt; Clupea                       NA  1376.4      NA       NA      NA       NA</span></span>
<span><span class="co">#&gt; Clupea harengus              NA      NA      NA       NA 40580.2       NA</span></span>
<span><span class="co">#&gt; Corystes cassivelanus        NA      NA      NA       NA      NA       NA</span></span>
<span><span class="co">#&gt; Hippogloss. Platessoides     NA      NA  7703.9  20190.5      NA       NA</span></span>
<span><span class="co">#&gt; Limanda limanda          1346.0 11131.7 14402.5  81084.9 42601.9       NA</span></span>
<span><span class="co">#&gt; Macropipus holsatus          NA      NA      NA       NA      NA       NA</span></span>
<span><span class="co">#&gt; Merlangius merlangus         NA      NA      NA       NA      NA 129775.9</span></span>
<span><span class="co">#&gt; Solea solea                  NA      NA      NA  31524.0      NA       NA</span></span>
<span><span class="co">#&gt; all                      7517.7 12508.1 22106.4 132799.3 83182.1 129775.9</span></span>
<span><span class="co">#&gt;                            9999      all</span></span>
<span><span class="co">#&gt; Aphrodite aculeata       6128.7   6128.7</span></span>
<span><span class="co">#&gt; Callionymus lyra             NA   6171.7</span></span>
<span><span class="co">#&gt; Clupea                       NA   1376.4</span></span>
<span><span class="co">#&gt; Clupea harengus              NA  40580.2</span></span>
<span><span class="co">#&gt; Corystes cassivelanus     850.6    850.6</span></span>
<span><span class="co">#&gt; Hippogloss. Platessoides     NA  27894.3</span></span>
<span><span class="co">#&gt; Limanda limanda              NA 150566.9</span></span>
<span><span class="co">#&gt; Macropipus holsatus       622.9    622.9</span></span>
<span><span class="co">#&gt; Merlangius merlangus         NA 129775.9</span></span>
<span><span class="co">#&gt; Solea solea                  NA  31524.0</span></span>
<span><span class="co">#&gt; all                      7602.2 395491.7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  sample_id: Gadus morhua_SCO_y:91_q:1_ID:582  fish_id: 582 </span></span>
<span><span class="co">#&gt; Number of stomachs ('n_tot'): 4 </span></span>
<span><span class="co">#&gt;                         120    200 9999     all</span></span>
<span><span class="co">#&gt; Clupea harengus          NA 8617.5   NA  8617.5</span></span>
<span><span class="co">#&gt; Trisopterus esmarkii 2349.4     NA  3.4  2352.8</span></span>
<span><span class="co">#&gt; all                  2349.4 8617.5  3.4 10970.3</span></span>
<span>  <span class="fu"><a href="../reference/do_detailed_output.html">do_detailed_output</a></span><span class="op">(</span><span class="va">s</span>, by_sample_id<span class="op">=</span><span class="cn">TRUE</span>,to_screen<span class="op">=</span><span class="cn">TRUE</span>,rel_weight <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  sample_id: Gadus morhua_FRA_y:91_q:1_ID:1008  fish_id: 1008 </span></span>
<span><span class="co">#&gt; Number of stomachs ('n_tot'): 1 </span></span>
<span><span class="co">#&gt;                           80 100 120  150  200  250 9999   all</span></span>
<span><span class="co">#&gt; Aphrodite aculeata        NA  NA  NA   NA   NA   NA  1.5   1.5</span></span>
<span><span class="co">#&gt; Callionymus lyra         1.6  NA  NA   NA   NA   NA   NA   1.6</span></span>
<span><span class="co">#&gt; Clupea                    NA 0.3  NA   NA   NA   NA   NA   0.3</span></span>
<span><span class="co">#&gt; Clupea harengus           NA  NA  NA   NA 10.3   NA   NA  10.3</span></span>
<span><span class="co">#&gt; Corystes cassivelanus     NA  NA  NA   NA   NA   NA  0.2   0.2</span></span>
<span><span class="co">#&gt; Hippogloss. Platessoides  NA  NA 1.9  5.1   NA   NA   NA   7.1</span></span>
<span><span class="co">#&gt; Limanda limanda          0.3 2.8 3.6 20.5 10.8   NA   NA  38.1</span></span>
<span><span class="co">#&gt; Macropipus holsatus       NA  NA  NA   NA   NA   NA  0.2   0.2</span></span>
<span><span class="co">#&gt; Merlangius merlangus      NA  NA  NA   NA   NA 32.8   NA  32.8</span></span>
<span><span class="co">#&gt; Solea solea               NA  NA  NA  8.0   NA   NA   NA   8.0</span></span>
<span><span class="co">#&gt; all                      1.9 3.2 5.6 33.6 21.0 32.8  1.9 100.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  sample_id: Gadus morhua_SCO_y:91_q:1_ID:582  fish_id: 582 </span></span>
<span><span class="co">#&gt; Number of stomachs ('n_tot'): 4 </span></span>
<span><span class="co">#&gt;                       120  200 9999   all</span></span>
<span><span class="co">#&gt; Clupea harengus        NA 78.6   NA  78.6</span></span>
<span><span class="co">#&gt; Trisopterus esmarkii 21.4   NA    0  21.4</span></span>
<span><span class="co">#&gt; all                  21.4 78.6    0 100.0</span></span></code></pre></div>
<p>The shown stomach contents in absolute terms have changed due to the
changes from observed stomach content to evacuation ratio (or food
ration), in grammes (you can see the initial observed values of stomach
contents in section “Showing a subset of data”). The unit is grammes per
quarter (parameter hour_multiplier=2190) whereas the evacuation model
uses the unit grammes per hour. In relative terms, <em>Clupea
harengus</em> has changed from 77.2% to 78.6 % for sample fish_id: 582.
On sample level this change is due to the prey specific armament value
(1.08 for <em>Clupea harengus</em>, and 1.0 for <em>Trisopterus
esmarkii</em>. The difference in energy contents of the various preys
does not change the relative stomach contents as the average energy
content for the entire stomach is used in the calculation. See help for
bias_correct_energy_etc() for more details.</p>
</div>
<div class="section level3">
<h3 id="size-classes-on-predator-and-preys-">Size classes on predator and preys.<a class="anchor" aria-label="anchor" href="#size-classes-on-predator-and-preys-"></a>
</h3>
<p>Stomach contents may be recorded by length e.g. cm group or other
size classes. For this examples, size classes which range depended on
the size (e.g. 50-60 mm and 100-120 mm) was used in the sampling
protocol and data compilation. Size classes are user defined and must
include a lower and upper size (length) for each species.</p>
<p>First the size classes are made from specifications, which in this
case are from an input CSV file within the FishStomachs.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, package <span class="op">=</span> <span class="st">'FishStomachs'</span><span class="op">)</span>,<span class="st">'length_classes_config.csv'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     l Species   y1   y2 q1 q2</span></span>
<span><span class="co">#&gt; 1  50     ALL 1981 1981  1  4</span></span>
<span><span class="co">#&gt; 2  70     ALL 1981 1981  1  4</span></span>
<span><span class="co">#&gt; 3 100     ALL 1981 1981  1  4</span></span>
<span><span class="co">#&gt; 4 150     ALL 1981 1981  1  4</span></span>
<span><span class="co">#&gt; 5 200     ALL 1981 1981  1  4</span></span>
<span><span class="co">#&gt; 6 250     ALL 1981 1981  1  4</span></span>
<span><span class="va">ll</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/make_length_classess.html">make_length_classess</a></span><span class="op">(</span>inp_dir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, package <span class="op">=</span> <span class="st">'FishStomachs'</span><span class="op">)</span>,inp_file<span class="op">=</span><span class="st">'length_classes_config.csv'</span><span class="op">)</span></span>
<span><span class="va">ll</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,136 × 7</span></span></span>
<span><span class="co">#&gt;    Species  year quarter    l1    l2    no group    </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> ALL      <span style="text-decoration: underline;">1</span>981       1    50    69     1 0050-0069</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> ALL      <span style="text-decoration: underline;">1</span>981       1    70    99     2 0070-0099</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> ALL      <span style="text-decoration: underline;">1</span>981       1   100   149     3 0100-0149</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> ALL      <span style="text-decoration: underline;">1</span>981       1   150   199     4 0150-0199</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ALL      <span style="text-decoration: underline;">1</span>981       1   200   249     5 0200-0249</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> ALL      <span style="text-decoration: underline;">1</span>981       1   250   299     6 0250-0299</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> ALL      <span style="text-decoration: underline;">1</span>981       1   300   399     7 0300-0399</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ALL      <span style="text-decoration: underline;">1</span>981       1   400   499     8 0400-0499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ALL      <span style="text-decoration: underline;">1</span>981       1   500   699     9 0500-0699</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> ALL      <span style="text-decoration: underline;">1</span>981       1   700   999    10 0700-0999</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 2,126 more rows</span></span></span>
<span><span class="co"># we use the coarser 1981 definition, just for illustrative purposes</span></span>
<span><span class="va">ll</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ll</span>,<span class="va">year</span><span class="op">==</span><span class="fl">1981</span><span class="op">)</span>; <span class="va">ll</span><span class="op">$</span><span class="va">year</span><span class="op">&lt;-</span><span class="fl">1991</span> </span></code></pre></div>
<p>The specification file includes lower size range for a given size
class, together with the span of years, quarters and species this should
be applied to. The Species variable is in this case “All” which includes
all species, however it could also include individual species names,
which makes it possible to assign species specific size classes.
Function make_length_classess transforms the specifications into size
classes by individual year and quarters.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/put_size_class_on_predator.html">put_size_class_on_predator</a></span><span class="op">(</span><span class="va">s</span>,len_classes<span class="op">=</span><span class="va">ll</span><span class="op">)</span> <span class="co"># add variables pred_size_class and pred_size.</span></span>
<span><span class="co">#&gt; The same length classes wil be applied for all predators</span></span>
<span><span class="va">s</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/put_size_class_on_prey.html">put_size_class_on_prey</a></span><span class="op">(</span><span class="va">s</span>,len_classes<span class="op">=</span><span class="va">ll</span>,too_small_to_other <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>     <span class="co"># add variables prey_size_class and prey_size.</span></span>
<span><span class="co">#&gt; The same length classes wil be applied for all preys.</span></span>
<span><span class="co">#&gt; [1] "Size classes were not found for  2486  records"</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,486 × 14</span></span></span>
<span><span class="co">#&gt;    sample_id fish_id prey_…¹ digest prey_l prey_ll prey_lu prey_…² prey_n prey_w</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Gadus mo… 109     Buglos…      1   <span style="text-decoration: underline;">9</span>999      35      40 r            1 5.81<span style="color: #949494;">e</span>2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Gadus mo… 116     Pseudo…      1   <span style="text-decoration: underline;">9</span>999      12      15 r            1 1.50<span style="color: #949494;">e</span>2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Gadus mo… 116     Gammar…      1   <span style="text-decoration: underline;">9</span>999      12      15 r            1 1.00<span style="color: #949494;">e</span>2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Gadus mo… 116     Crango…      1   <span style="text-decoration: underline;">9</span>999      25      30 r            1 3.90<span style="color: #949494;">e</span>2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Gadus mo… 131     Crango…      1   <span style="text-decoration: underline;">9</span>999      25      30 r            1 9.44<span style="color: #949494;">e</span>2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Gadus mo… 15      Pomato…      1   <span style="text-decoration: underline;">9</span>999      40      50 r            1 3.25<span style="color: #949494;">e</span>2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Gadus mo… 16      Mysidae      1   <span style="text-decoration: underline;">9</span>999      12      15 r            1 8.50<span style="color: #949494;">e</span>0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Gadus mo… 16      Gammar…      1   <span style="text-decoration: underline;">9</span>999      10      12 r            2 1.70<span style="color: #949494;">e</span>1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Gadus mo… 16      Crango…      1   <span style="text-decoration: underline;">9</span>999      30      35 r            2 1.55<span style="color: #949494;">e</span>2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Gadus mo… 164     Crango…      1   <span style="text-decoration: underline;">9</span>999      40      50 r            1 1.69<span style="color: #949494;">e</span>3</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 2,476 more rows, 4 more variables: prey_nodc &lt;dbl&gt;, year &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   quarter &lt;int&gt;, prey_l_mean &lt;int&gt;, and abbreviated variable names</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ¹​prey_name, ²​prey_w_meth</span></span></span>
<span><span class="co">#&gt; [1] "Preys from these records were renamed to 'other food'"</span></span>
<span><span class="va">s</span></span>
<span><span class="co">#&gt; Object of class 'STOMobs'</span></span>
<span><span class="co">#&gt; ===========================</span></span>
<span><span class="co">#&gt; Number of samples: 4104 </span></span>
<span><span class="co">#&gt; Number stomachs: 9660 </span></span>
<span><span class="co">#&gt; Predators: Gadus morhua </span></span>
<span><span class="co">#&gt; Number of prey names: 210 </span></span>
<span><span class="co">#&gt; Years: 1991 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; TRUE:  Changes done</span></span>
<span><span class="co">#&gt; TRUE:  Prey weights by record done</span></span>
<span><span class="co">#&gt; TRUE:  Bias corrected, energy contents, armament etc</span></span>
<span><span class="co">#&gt; TRUE:  Predator size class assigned</span></span>
<span><span class="co">#&gt; FALSE: Bias corrected, regurgitated stomachs</span></span>
<span><span class="co">#&gt; TRUE:  Prey size class assigned</span></span>
<span><span class="co">#&gt; FALSE: Aggregate by sample ID and predator and prey size group</span></span>
<span><span class="co">#&gt; FALSE: Temporal and spatial strata added</span></span>
<span><span class="co">#&gt; FALSE: Allocate partly identified prey species</span></span>
<span><span class="co">#&gt; FALSE: Allocate missing prey length</span></span>
<span><span class="fu"><a href="../reference/do_detailed_output.html">do_detailed_output</a></span><span class="op">(</span><span class="va">s</span>, by_sample_id<span class="op">=</span><span class="cn">TRUE</span>,to_screen<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  sample_id: Gadus morhua_FRA_y:91_q:1_ID:1008  fish_id: 1008 </span></span>
<span><span class="co">#&gt; Number of stomachs ('n_tot'): 1 </span></span>
<span><span class="co">#&gt;                              70     100      150     200      250   9999</span></span>
<span><span class="co">#&gt; Aphrodite aculeata           NA      NA       NA      NA       NA 6128.7</span></span>
<span><span class="co">#&gt; Callionymus lyra         6171.7      NA       NA      NA       NA     NA</span></span>
<span><span class="co">#&gt; Clupea                       NA  1376.4       NA      NA       NA     NA</span></span>
<span><span class="co">#&gt; Clupea harengus              NA      NA       NA 40580.2       NA     NA</span></span>
<span><span class="co">#&gt; Corystes cassivelanus        NA      NA       NA      NA       NA  850.6</span></span>
<span><span class="co">#&gt; Hippogloss. Platessoides     NA  7703.9  20190.5      NA       NA     NA</span></span>
<span><span class="co">#&gt; Limanda limanda          1346.0 25534.2  81084.9 42601.9       NA     NA</span></span>
<span><span class="co">#&gt; Macropipus holsatus          NA      NA       NA      NA       NA  622.9</span></span>
<span><span class="co">#&gt; Merlangius merlangus         NA      NA       NA      NA 129775.9     NA</span></span>
<span><span class="co">#&gt; Solea solea                  NA      NA  31524.0      NA       NA     NA</span></span>
<span><span class="co">#&gt; all                      7517.7 34614.5 132799.3 83182.1 129775.9 7602.2</span></span>
<span><span class="co">#&gt;                               all</span></span>
<span><span class="co">#&gt; Aphrodite aculeata         6128.7</span></span>
<span><span class="co">#&gt; Callionymus lyra           6171.7</span></span>
<span><span class="co">#&gt; Clupea                     1376.4</span></span>
<span><span class="co">#&gt; Clupea harengus           40580.2</span></span>
<span><span class="co">#&gt; Corystes cassivelanus       850.6</span></span>
<span><span class="co">#&gt; Hippogloss. Platessoides  27894.3</span></span>
<span><span class="co">#&gt; Limanda limanda          150566.9</span></span>
<span><span class="co">#&gt; Macropipus holsatus         622.9</span></span>
<span><span class="co">#&gt; Merlangius merlangus     129775.9</span></span>
<span><span class="co">#&gt; Solea solea               31524.0</span></span>
<span><span class="co">#&gt; all                      395491.7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  sample_id: Gadus morhua_SCO_y:91_q:1_ID:582  fish_id: 582 </span></span>
<span><span class="co">#&gt; Number of stomachs ('n_tot'): 4 </span></span>
<span><span class="co">#&gt;                         100    200 9999     all</span></span>
<span><span class="co">#&gt; Clupea harengus          NA 8617.5   NA  8617.5</span></span>
<span><span class="co">#&gt; Trisopterus esmarkii 2349.4     NA  3.4  2352.8</span></span>
<span><span class="co">#&gt; all                  2349.4 8617.5  3.4 10970.3</span></span></code></pre></div>
<p>The detailed output show that the the size class 100-150 now include
the 100 and the 120 mm size classes as the 1981 size class have been
used.</p>
</div>
<div class="section level3">
<h3 id="bias-correct-regurgitated-stomachs-">Bias correct regurgitated stomachs.<a class="anchor" aria-label="anchor" href="#bias-correct-regurgitated-stomachs-"></a>
</h3>
<p>Regurgitated stomachs are from feeding fish, but their actual
absolute stomach contents (in the sea) are not known. Stomach contents
from regurgitated stomach are not analysed or included as data, however
the number of regurgitated stomachs (n_regur) should be noted together
with the number of stomachs with skeletal remains only (n_nskel) and the
number of empty stomachs (n_empty). The bias correction assumes that the
regurgitated stomachs have had a the same stomach contents as the
observed feeding fish (n_food). See the help(bias_correct_regurgitated)
for more details.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#overview of number of stomachs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s</span>,level<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of stomachs by predator and year:</span></span>
<span><span class="co">#&gt;                    n_food n_empty n_skel n_regur n_tot</span></span>
<span><span class="co">#&gt; pred_name    year                                     </span></span>
<span><span class="co">#&gt; Gadus morhua 1991    8125     982     22     531  9660</span></span>
<span></span>
<span><span class="va">s</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/bias_correct_regurgitated.html">bias_correct_regurgitated</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/do_detailed_output.html">do_detailed_output</a></span><span class="op">(</span><span class="va">s</span>, by_sample_id<span class="op">=</span><span class="cn">TRUE</span>,to_screen<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  sample_id: Gadus morhua_FRA_y:91_q:1_ID:1008  fish_id: 1008 </span></span>
<span><span class="co">#&gt; Number of stomachs ('n_tot'): 1 </span></span>
<span><span class="co">#&gt;                              70     100      150     200      250   9999</span></span>
<span><span class="co">#&gt; Aphrodite aculeata           NA      NA       NA      NA       NA 6128.7</span></span>
<span><span class="co">#&gt; Callionymus lyra         6171.7      NA       NA      NA       NA     NA</span></span>
<span><span class="co">#&gt; Clupea                       NA  1376.4       NA      NA       NA     NA</span></span>
<span><span class="co">#&gt; Clupea harengus              NA      NA       NA 40580.2       NA     NA</span></span>
<span><span class="co">#&gt; Corystes cassivelanus        NA      NA       NA      NA       NA  850.6</span></span>
<span><span class="co">#&gt; Hippogloss. Platessoides     NA  7703.9  20190.5      NA       NA     NA</span></span>
<span><span class="co">#&gt; Limanda limanda          1346.0 25534.2  81084.9 42601.9       NA     NA</span></span>
<span><span class="co">#&gt; Macropipus holsatus          NA      NA       NA      NA       NA  622.9</span></span>
<span><span class="co">#&gt; Merlangius merlangus         NA      NA       NA      NA 129775.9     NA</span></span>
<span><span class="co">#&gt; Solea solea                  NA      NA  31524.0      NA       NA     NA</span></span>
<span><span class="co">#&gt; all                      7517.7 34614.5 132799.3 83182.1 129775.9 7602.2</span></span>
<span><span class="co">#&gt;                               all</span></span>
<span><span class="co">#&gt; Aphrodite aculeata         6128.7</span></span>
<span><span class="co">#&gt; Callionymus lyra           6171.7</span></span>
<span><span class="co">#&gt; Clupea                     1376.4</span></span>
<span><span class="co">#&gt; Clupea harengus           40580.2</span></span>
<span><span class="co">#&gt; Corystes cassivelanus       850.6</span></span>
<span><span class="co">#&gt; Hippogloss. Platessoides  27894.3</span></span>
<span><span class="co">#&gt; Limanda limanda          150566.9</span></span>
<span><span class="co">#&gt; Macropipus holsatus         622.9</span></span>
<span><span class="co">#&gt; Merlangius merlangus     129775.9</span></span>
<span><span class="co">#&gt; Solea solea               31524.0</span></span>
<span><span class="co">#&gt; all                      395491.7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  sample_id: Gadus morhua_SCO_y:91_q:1_ID:582  fish_id: 582 </span></span>
<span><span class="co">#&gt; Number of stomachs ('n_tot'): 4 </span></span>
<span><span class="co">#&gt;                         100     200 9999     all</span></span>
<span><span class="co">#&gt; Clupea harengus          NA 25852.5   NA 25852.5</span></span>
<span><span class="co">#&gt; Trisopterus esmarkii 7048.3      NA 10.2  7058.5</span></span>
<span><span class="co">#&gt; all                  7048.3 25852.5 10.2 32911.0</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s</span>,level<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of stomachs by predator and year:</span></span>
<span><span class="co">#&gt;              year 1991</span></span>
<span><span class="co">#&gt; pred_name             </span></span>
<span><span class="co">#&gt; Gadus morhua      9660</span></span></code></pre></div>
<p>fish_id: 1008 sample consists of one cod stomach with food, so the
bias correction has no effect. fish_id: 582 sample include one cod with
food, one cod with empty stomach and 2 cods with regurgitated stomachs.
The contents of the one stomach was 549.8 g (is is actually the ration
eaten by quarter), as the the bias correction for energy contents
<em>etc</em> has been made. With the assumption that the regurgitated
stomach had the same stomach content as the one feeding cod the four cod
would in total have a total stomach contents (ration) of 3*549.8 g =
1649.5 g.</p>
<p>Information on regurgitated and empty stomach are by default deleted
by the bias correction, such that only the total number of stomachs
(n_tot) are kept.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Morten Vinther.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
